// Perth Transit JS API
//
// Version:   1.0
// Requires:  jQuery
// License:   MIT
// Copyright: Darcy Laycock
(function(e,t){var n={version:1,root:"http://api.perthtransit.com/"},r=function(e){if(!e)return null;var t=e.lat||e.latitude,n=e.lng||e.lon||e.longitude,r=""+t+","+n;return{near:r}},i=function(e){var t=typeof e;return t==="number"||t==="string"?""+e:e.identifier},s=function(t){var n=e.Deferred(),r=function(e){var r=t(e.coords);r.then(n.resolve,n.reject)};return navigator.geolocation.getCurrentPosition(r,null,{maximumAge:6e5}),n};n.get=function(t,n){var r=this.urlFor(t,n),i=e.getJSON(r),s=function(e){return e.response},o=function(e){return e};return i.pipe(s,o)},n.urlFor=function(t,n){var r=this.root+this.version+"/"+t+"?callback=?";return n&&(r=r+"&"+e.param(n)),r},n.nearbyTrainStations=function(){return s(function(e){return n.trainStations(e)})},n.nearbyBusStops=function(){return s(function(e){return n.busStops(e)})},n.trainStations=function(e){return this.get("train_stations",r(e))},n.trainStation=function(e){return this.get("train_stations/"+i(e))},n.busStops=function(e){return this.get("bus_stops",r(e))},n.busStop=function(e){return this.get("bus_stops/"+i(e))},n.smartRider=function(e){return this.get("smart_riders/"+e)},window.PerthTransit=n})(jQuery);